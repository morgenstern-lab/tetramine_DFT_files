#!/bin/bash

##########
#update the variables below as needed
##########

JOB=TETSpOHH3O+_s3H3O_GS.TS_search	#this is the name of your job
		#make sure there are no spaces in the name
CURDIR=`'pwd'`  #do not change this line
TIME='23:00:00' #run time (hh:mm:ss) - 2 hours
NODES=1		#total number of nodes
TASKS=128        #total number of mpi tasks requested
		#should be 64 tasks per node

#########
#Do not change this next section!
#########
cat > $JOB.sbatch << EOF_ALL
#!/bin/sh

#SBATCH -J $JOB  	         # job name
#SBATCH -o $CURDIR/$JOB.out
#SBATCH -e $CURDIR/$JOB.err
#SBATCH -N $NODES                # total number of nodes 
#SBATCH -n $TASKS                # total number of mpi tasks requested
#SBATCH -t $TIME                 # run time (hh:mm:ss) - 1.5 hours

#!/bin/sh

AMS_JOBNAME=$JOB $AMSBIN/ams << eor

########
#replace the lines below with your adf input file
########

Task TransitionStateSearch
Properties
    NormalModes Yes
End
GeometryOptimization
    InitialHessian
        Type Calculate
    End
End
System
    Atoms
        O 2.42204625826497 -0.7441475654187844 -0.2248219846917269 
        O 1.490076164277268 0.084356495186463 1.966315824034745 
        S 1.34088584541431 -0.2601825733881674 0.5829469814489578 
        N 0.7078950370909222 1.084948118677819 -0.2347033064491977 
        N -0.009825686729095878 -1.277864595007397 0.4750671455231164 
        N -1.653027389990076 1.36065428456802 0.6144792820138114 
        S -2.204697700301703 0.5463683962112525 -0.8216226551030918 
        N -0.8929218532949202 -0.1936028317199575 -1.502369417808272 
        O -3.188344841446023 -0.4197471849137503 -0.4496072510122227 
        O -2.53651597153203 1.666745829461857 -1.694119368247231 
        C -0.2461660120696986 1.925295076001952 0.4690419739383629 
        C -0.5105472036593574 -1.485873457200524 -0.9035684963813205 
        C -1.955607590701191 0.7567129528636821 1.935152547046078 
        C 0.2718010398487526 0.7321116943354326 -1.588277297823371 
        H 0.111955021912888 2.134955937411819 1.472204557691714 
        H -0.3130376483894837 2.85620728445477 -0.09193984134209662 
        H 0.2337027998453784 -1.921122003159721 -1.573190040149353 
        H -1.378707795095728 -2.136279140992868 -0.8528345738371022 
        H -1.048715659103676 0.3732133777595116 2.399115009786772 
        H -2.683946239826833 -0.04057593123073695 1.801412336063099 
        H -0.01209515176782381 1.628174341171612 -2.133341091380831 
        H 1.069636399531634 0.2220327093037142 -2.120220208461115 
        H 0.1862952284689578 -2.155485631311806 0.9553875678454758 
        O -2.495971625559589 1.854713273487954 2.661313859540967 
        H -2.608688749760009 1.61345248459825 3.592690262185005 
        O -3.552891423591573 3.142413162547516 0.1629225452308167 
        H -2.783347384004284 2.590415404021724 0.6296891325583791 
        H -3.492323324546725 4.103092779413724 0.3118549177390189 
        H -3.404429719076173 2.883091615632437 -0.7967666348353981 
    End
    Charge 1.0
    BondOrders
         1 3 2.0
         2 3 2.0
         3 4 1.0
         3 5 1.0
         4 11 1.0
         4 14 1.0
         5 12 1.0
         5 23 1.0
         6 7 1.0
         6 11 1.0
         6 13 1.0
         7 8 1.0
         7 9 2.0
         7 10 2.0
         8 12 1.0
         8 14 1.0
         11 15 1.0
         11 16 1.0
         12 17 1.0
         12 18 1.0
         13 19 1.0
         13 20 1.0
         13 24 1.0
         14 21 1.0
         14 22 1.0
         24 25 1.0
         26 28 1.0
         26 29 1.0
         27 26 1.0
    End
End

Engine ADF
    Basis
        Type TZP
        Core None
    End
    XC
        Hybrid B3LYP
    End
    Relativity
        Level None
    End
EndEngine
eor


########
#do not change the rest of the file!
########

mv $JOB.results/ams.log $JOB.logfile
rm slurm-*.out

EOF_ALL

sbatch < $JOB.sbatch
