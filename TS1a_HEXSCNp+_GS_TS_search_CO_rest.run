#!/bin/bash

##########
#update the variables below as needed
##########

JOB=HEXSCNp+_GS_TS_search_CO_rest	#this is the name of your job
		#make sure there are no spaces in the name
CURDIR=`'pwd'`  #do not change this line
TIME='23:00:00' #run time (hh:mm:ss) - 2 hours
NODES=1		#total number of nodes
TASKS=128        #total number of mpi tasks requested
		#should be 64 tasks per node

#########
#Do not change this next section!
#########
cat > $JOB.sbatch << EOF_ALL
#!/bin/sh

#SBATCH -J $JOB  	         # job name
#SBATCH -o $CURDIR/$JOB.out
#SBATCH -e $CURDIR/$JOB.err
#SBATCH -N $NODES                # total number of nodes 
#SBATCH -n $TASKS                # total number of mpi tasks requested
#SBATCH -t $TIME                 # run time (hh:mm:ss) - 1.5 hours

#!/bin/sh

AMS_JOBNAME=$JOB $AMSBIN/ams << eor

########
#replace the lines below with your adf input file
#starting with the "Task"
########

Task TransitionStateSearch
Properties
    NormalModes Yes
End
GeometryOptimization
    InitialHessian
        Type Calculate
    End
End
Restraints
    Distance 21 5 4.002 0.35 
    Distance 2 21 3.719 0.35 
End
System
    Atoms
        H 3.348184895531517 -1.52549859946759 3.42956831028269 
        O 3.088591291989465 -2.432169480410537 3.209112438703101 
        H 3.837643546950992 -2.983463494666138 3.475306996396623 
        H 1.382718372627985 -3.01411287156391 3.662308947050442 
        O 0.4315402147975414 -3.239521668424196 3.628528140771921 
        H 0.2231208913946813 -3.646970490723071 4.47904782523621 
        N -1.562363507067375 -1.314802713612364 0.01400178309053639 
        C -0.5842955354899667 -1.778208368897933 -1.033118950677234 
        N 0.7480296778954788 -1.257337179381778 -0.8073872625346104 
        C 1.407471433987102 -1.596544677221126 0.437467942620664 
        N 0.626127798902789 -1.083397884744313 1.590867587076774 
        C -0.5561773804209807 -1.645194487866475 1.798113350930358 
        N -1.365509527928048 1.417645953228958 -0.2504809083722245 
        C -0.5556655693299766 1.795578673491844 -1.429760023403256 
        N 0.8484619629423081 1.453775688239454 -1.23004890926232 
        C 1.400180186241512 1.976643983088593 0.01892351244449995 
        N 0.5558583118942805 1.63576844279673 1.188330706106594 
        C -0.8604683560770848 1.978143162047999 1.006430275127514 
        S -2.445441475965767 0.2020076615935429 -0.2827834523365247 
        S 1.37829855574987 -0.0363959807983683 -1.792343771897773 
        S 0.9812535043707604 0.4861143971375713 2.274175344870288 
        O -2.934242285817868 0.09078450400389583 -1.624715086417626 
        O -3.266958345823726 0.2878415715027391 0.8868654619981025 
        O 0.7465676078855812 -0.2161749809218516 -3.064084836782163 
        O 2.790234864227457 -0.05771220445661711 -1.557000426814801 
        O 0.08788301726805219 0.5837599574058362 3.385607176496579 
        O 2.410855051615469 0.4870599470342645 2.361873541602171 
        H -0.9229175828649414 -1.514495730934001 -2.032439256738232 
        H -0.5584350706590476 -2.867629789198142 -0.9569944397104291 
        H 2.412134234128098 -1.191614102443197 0.4605803905370907 
        H 1.465635131114285 -2.679522639221978 0.5563917544405184 
        H -1.231547953829607 -1.199745789779832 2.513780689279563 
        H -0.6330173590095695 -2.707894938098524 1.623035003970488 
        H -0.6287839332464844 2.878687109449539 -1.538805551228353 
        H -0.9451739310358945 1.326473292967407 -2.326077186459553 
        H 1.410616269645105 3.065307983833657 -0.0541418352229259 
        H 2.415358858869348 1.627273565329893 0.1693642182676198 
        H -0.9307264669571425 3.065001972952867 0.936820258240103 
        H -1.456321373997179 1.646057706870777 1.849255011811648 
        H -2.320009866308502 -1.998513248857546 0.08302983715373743 
    End
    Charge 1.0
    BondOrders
         1 2 1.0
         2 3 1.0
         4 5 1.0
         5 6 1.0
         7 8 1.0
         7 19 1.0
         7 40 1.0
         8 9 1.0
         8 28 1.0
         8 29 1.0
         9 10 1.0
         9 20 1.0
         10 11 1.0
         10 30 1.0
         10 31 1.0
         11 12 1.0
         11 21 1.0
         12 32 1.0
         12 33 1.0
         13 14 1.0
         13 18 1.0
         13 19 1.0
         14 15 1.0
         14 34 1.0
         14 35 1.0
         15 16 1.0
         15 20 1.0
         16 17 1.0
         16 36 1.0
         16 37 1.0
         17 18 1.0
         17 21 1.0
         18 38 1.0
         18 39 1.0
         19 22 2.0
         19 23 2.0
         20 24 2.0
         20 25 2.0
         21 26 2.0
         21 27 2.0
    End
End

Engine ADF
    Basis
        Type TZP
        Core None
    End
    XC
        Hybrid B3LYP
    End
    Relativity
        Level None
    End
EndEngine
eor


########
#do not change the rest of the file!
########

mv $JOB.results/ams.log $JOB.logfile
rm slurm-*.out

EOF_ALL

sbatch < $JOB.sbatch
