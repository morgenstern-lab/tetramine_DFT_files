#!/bin/bash

##########
#update the variables below as needed
##########

JOB=TETSCNp+_GS.TS_search	#this is the name of your job
		#make sure there are no spaces in the name
CURDIR=`'pwd'`  #do not change this line
TIME='23:00:00' #run time (hh:mm:ss) - 2 hours
NODES=1		#total number of nodes
TASKS=128        #total number of mpi tasks requested
		#should be 64 tasks per node

#########
#Do not change this next section!
#########
cat > $JOB.sbatch << EOF_ALL
#!/bin/sh

#SBATCH -J $JOB  	         # job name
#SBATCH -o $CURDIR/$JOB.out
#SBATCH -e $CURDIR/$JOB.err
#SBATCH -N $NODES                # total number of nodes 
#SBATCH -n $TASKS                # total number of mpi tasks requested
#SBATCH -t $TIME                 # run time (hh:mm:ss) - 1.5 hours

#!/bin/sh

AMS_JOBNAME=$JOB $AMSBIN/ams << eor

########
#replace the lines below with your adf input file
#starting with the "Task"
########

Task TransitionStateSearch
Properties
    NormalModes Yes
End
GeometryOptimization
    InitialHessian
        Type Calculate
    End
End
System
    Atoms
        O 2.27934875205977 -1.283373417755251 0.03773539489311607 
        O 1.560052973329782 0.1130133602008504 2.017636084467856 
        S 1.390509415067147 -0.3716209525739778 0.6840537143032303 
        N 1.090279700635721 0.9078358236280046 -0.3486238263164457 
        N -0.2306266834803026 -1.050914446184178 0.6358402720869042 
        N -1.211859487663024 1.375982220993095 0.315762502102821 
        S -1.861388258579158 0.8828592902596423 -1.241636044976443 
        N -0.6525768900646565 -0.2226987097402427 -1.631032233534513 
        O -3.070962464620337 0.1705818244863936 -0.9827149037998977 
        O -1.732342322461983 2.010617824730704 -2.101681438779868 
        C 0.1693222166501754 1.925521235184205 0.199056039939598 
        C -0.6425199103875747 -1.414358934230336 -0.7773924189302824 
        C -1.428069525543777 0.4946241927634716 1.301196204164167 
        C 0.6776763627494292 0.4362997487316382 -1.695031523334147 
        H 0.5006944637130132 2.243975260773499 1.182804774227526 
        H 0.1523951894600004 2.771969865054336 -0.4808189092570257 
        H 0.0606302041372088 -2.130497867596386 -1.200729416838642 
        H -1.636064964989353 -1.851136335439884 -0.7359338013513669 
        H -0.9005977401655324 0.6303672040263182 2.231636185600034 
        H -2.35668753980065 -0.05347171198988029 1.300264040163112 
        H 0.6273363838706623 1.288560432221542 -2.365453071476213 
        H 1.404370772411992 -0.2787336221197686 -2.068677864455898 
        H -0.2806669553255279 -1.858702209973284 1.26180035541919 
        O -2.750450720295527 2.112827541682607 2.667089534643392 
        H -3.178474059431035 2.068007027197755 3.532383304774363 
        O -4.332593059889211 2.985017559360441 0.6123828771342706 
        H -3.421146584271838 2.473332323450451 2.047305366453005 
        H -5.201305561771012 2.618976152722577 0.3951394483581055 
        H -4.41366908091665 3.935227820204427 0.4493883961130077 
    End
    Charge 1.0
    BondOrders
         1 3 2.0
         2 3 2.0
         3 4 1.0
         3 5 1.0
         4 11 1.0
         4 14 1.0
         5 12 1.0
         5 23 1.0
         6 7 1.0
         6 11 1.0
         6 13 1.0
         7 8 1.0
         7 9 2.0
         7 10 2.0
         8 12 1.0
         8 14 1.0
         11 15 1.0
         11 16 1.0
         12 17 1.0
         12 18 1.0
         13 19 1.0
         13 20 1.0
         14 21 1.0
         14 22 1.0
         24 25 1.0
         24 27 1.0
         26 28 1.0
         26 29 1.0
    End
End

Engine ADF
    Basis
        Type TZP
        Core None
    End
    XC
        Hybrid B3LYP
    End
    Relativity
        Level None
    End
EndEngine
eor


########
#do not change the rest of the file!
########

mv $JOB.results/ams.log $JOB.logfile
rm slurm-*.out

EOF_ALL

sbatch < $JOB.sbatch
