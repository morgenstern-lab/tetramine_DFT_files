#!/bin/bash

##########
#update the variables below as needed
##########

JOB=TETSpCH3O+_AlliH2O_IRC	#this is the name of your job
		#make sure there are no spaces in the name
CURDIR=`'pwd'`  #do not change this line
TIME='23:00:00' #run time (hh:mm:ss) - 2 hours
NODES=1		#total number of nodes
TASKS=128        #total number of mpi tasks requested
		#should be 64 tasks per node

#########
#Do not change this next section!
#########
cat > $JOB.sbatch << EOF_ALL
#!/bin/sh

#SBATCH -J $JOB  	         # job name
#SBATCH -o $CURDIR/$JOB.out
#SBATCH -e $CURDIR/$JOB.err
#SBATCH -N $NODES                # total number of nodes 
#SBATCH -n $TASKS                # total number of mpi tasks requested
#SBATCH -t $TIME                 # run time (hh:mm:ss) - 1.5 hours

#!/bin/sh

AMS_JOBNAME=$JOB $AMSBIN/ams << eor

########
#replace the lines below with your adf input file
#starting with the "Task"
########

Task IRC
GeometryOptimization
    InitialHessian
        Type Calculate
    End
End
System
    Atoms
        O 2.48737421821143 -0.6920765059923272 -0.2299516654040092 adf.R=1.517
        O 1.646560331555676 0.5603272300391066 1.763691069720844 adf.R=1.517
        S 1.404834550249615 -0.04447692463746022 0.4780766888561649 adf.R=1.792
        N 0.7848418224049679 1.114164284825664 -0.5638982679170612 adf.R=1.608
        N 0.07591513909319701 -1.056270163271196 0.6371091610579206 adf.R=1.608
        N -1.498185319122 1.561594675639974 0.2893555111680706 adf.R=1.608
        S -2.198020530941862 0.6370256696938478 -0.9322431998259321 adf.R=1.792
        N -0.9356853319473586 -0.3122719851455198 -1.459022608018937 adf.R=1.608
        O -3.18271036849635 -0.2234648247308536 -0.2966322466176262 adf.R=1.517
        O -2.608597388572609 1.466971891014953 -2.038773930060211 adf.R=1.517
        C -0.1242317980535556 2.107399909208215 -0.008497235335932876 adf.R=1.7
        C -0.5653543263832379 -1.472419844424146 -0.646084340049767 adf.R=1.7
        C -2.208711341119387 0.4304925182538116 2.529663880019578 adf.R=1.7
        C 0.2477947328717157 0.510176657415871 -1.797960104991847 adf.R=1.7
        H 0.2674377523441117 2.487844882524274 0.9280474618920076 adf.R=1.35
        H -0.1852681117015814 2.917912027189395 -0.7334608589126412 adf.R=1.35
        H 0.09732156116129494 -2.079291586336636 -1.261698329735648 adf.R=1.35
        H -1.447521495979023 -2.047617128609021 -0.3899239327525999 adf.R=1.35
        H -1.850825509130872 1.093280177540753 3.30890517469209 adf.R=1.35
        H -1.556019887755879 -0.2832289721826931 2.03879587510439 adf.R=1.35
        H -0.02655659067090334 1.304229521593424 -2.484874230142024 adf.R=1.35
        H 0.988594294583898 -0.130433163233425 -2.264272848308437 adf.R=1.35
        H 0.3361815726548162 -1.870063853895419 1.193964118455075 adf.R=1.35
        O -3.441503314798509 0.4765200215923555 2.283877054706498 adf.R=1.517
        H -3.660911814806824 -0.07610063338193204 1.487135554739852 adf.R=1.35
        O -3.311948381426716 3.663753894427412 0.8535183354853155 adf.R=1.517
        H -3.154371319412364 4.116054780346764 1.696113459796613 adf.R=1.35
        H -2.140170961256594 2.35764455801649 0.4891389735579598 adf.R=1.35
        H -3.307343863655388 4.37507929688319 0.1953687647721831 adf.R=1.35
    End
    Charge 1.0
    BondOrders
         1 3 2.0
         2 3 2.0
         3 4 1.0
         3 5 1.0
         4 11 1.0
         4 14 1.0
         5 12 1.0
         5 23 1.0
         6 7 1.0
         6 11 1.0
         6 28 1.0
         7 8 1.0
         7 9 2.0
         7 10 2.0
         8 12 1.0
         8 14 1.0
         11 15 1.0
         11 16 1.0
         12 17 1.0
         12 18 1.0
         13 19 1.0
         13 20 1.0
         13 24 1.0
         14 21 1.0
         14 22 1.0
         24 25 1.0
         26 27 1.0
         26 29 1.0
    End
End

Engine ADF
    Basis
        Type TZP
        Core None
    End
    XC
        Hybrid B3LYP
    End
    Relativity
        Level None
    End
    Solvation
        Surf Delley
        Solv name=Water cav0=0.0 cav1=0.0067639
        Charged method=CONJ
        C-Mat POT
        SCF VAR ALL 
        CSMRSP
    End
EndEngine
eor


########
#do not change the rest of the file!
########

mv $JOB.results/ams.log $JOB.logfile
rm slurm-*.out

EOF_ALL

sbatch < $JOB.sbatch
