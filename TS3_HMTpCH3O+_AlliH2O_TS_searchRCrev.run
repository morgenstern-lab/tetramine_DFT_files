#!/bin/bash

##########
#update the variables below as needed
##########

JOB=HMTpCH3O+_AlliH2O_TS_searchRCrev	#this is the name of your job
		#make sure there are no spaces in the name
CURDIR=`'pwd'`  #do not change this line
TIME='20:00:00' #run time (hh:mm:ss) - 2 hours
NODES=1		#total number of nodes
TASKS=128        #total number of mpi tasks requested
		#should be 64 tasks per node

#########
#Do not change this next section!
#########
cat > $JOB.sbatch << EOF_ALL
#!/bin/sh

#SBATCH -J $JOB  	         # job name
#SBATCH -o $CURDIR/$JOB.out
#SBATCH -e $CURDIR/$JOB.err
#SBATCH -N $NODES                # total number of nodes 
#SBATCH -n $TASKS                # total number of mpi tasks requested
#SBATCH -t $TIME                 # run time (hh:mm:ss) - 1.5 hours

#!/bin/sh

AMS_JOBNAME=$JOB $AMSBIN/ams << eor

########
#replace the lines below with your adf input file
#starting with the "Task"
########

Task TransitionStateSearch
Properties
    NormalModes Yes
End
GeometryOptimization
    InitialHessian
        Type Calculate
    End
End
TransitionStateSearch
    ReactionCoordinate
        Distance 6 2 -1.0
    End
End
System
    Atoms
        N 1.041981280079581 -0.3553377781803603 -0.8509897822586224 adf.R=1.608
        N -0.1126539859392817 -0.582548862469889 1.297998454531533 adf.R=1.608
        N 1.138731018633211 1.717461127219668 0.4715140430796508 adf.R=1.608
        N -0.9839296529748596 0.9066133800152766 -0.4495862054272221 adf.R=1.608
        C 0.7417810119994861 -1.243555195520698 0.2574160051131783 adf.R=1.7
        C 1.730844529779295 1.183175690213301 3.337280644193043 adf.R=1.7
        C 1.848616681782949 0.8105594469878646 -0.4627380656765627 adf.R=1.7
        C -0.2205205312976509 0.1259916993224532 -1.434545257545752 adf.R=1.7
        C -1.32488641436243 0.05080692745785059 0.6718270914047986 adf.R=1.7
        C -0.195666847154158 2.086769202578434 -0.06961760350976802 adf.R=1.7
        H 0.235784843580481 -2.126584748401283 -0.1495626523463718 adf.R=1.35
        H 1.667339079874152 -1.574891835299328 0.7308136298114458 adf.R=1.35
        H 1.497870099470797 2.22303369787903 3.129006806546018 adf.R=1.35
        H 1.012275562308324 0.4540423416770158 3.713886433663334 adf.R=1.35
        H 2.771811574874995 0.46399371663099 0.005156942996621105 adf.R=1.35
        H 2.114700525306988 1.362902558712359 -1.364548480869361 adf.R=1.35
        H -0.8155822197652098 -0.7259370449841684 -1.764671565215877 adf.R=1.35
        H -0.002839803440769598 0.7513402682236308 -2.299648831285847 adf.R=1.35
        H -1.846389059252995 0.6269614580051119 1.437063342082426 adf.R=1.35
        H -2.007485546281407 -0.7240500062256141 0.304282569239031 adf.R=1.35
        H -0.738642669461029 2.658827146540315 0.6828649446443834 adf.R=1.35
        H -0.06664679714210781 2.717287018315713 -0.9496436113935987 adf.R=1.35
        H -0.4079770369448517 -1.267441993036095 1.991455007599569 adf.R=1.35
        O 2.932595746365692 0.762993623880609 3.216185113709247 adf.R=1.517
        H 3.548990732852715 1.448577067614827 2.888379302820428 adf.R=1.35
        H 0.8928442867004515 1.101746131401289 1.236394031397058 adf.R=1.35
        O -0.0727078619238046 -1.02116348694131 4.616467550859659 adf.R=1.517
        H -0.8522345055402333 -0.8479484626037166 5.163465656130058 adf.R=1.35
        H 0.3588167691919213 -1.771397204059413 5.049831796207957 adf.R=1.35
    End
    Charge 1.0
    BondOrders
         1 5 0.9764117002487183
         1 7 0.9874771237373352
         1 8 0.9630978107452393
         2 5 0.9728771448135376
         2 9 0.9734500646591187
         2 23 0.9362745881080627
         3 7 0.9452708959579468
         3 10 0.9338595867156982
         3 26 0.7900782227516174
         4 8 0.9630528688430786
         4 9 0.9763554930686951
         4 10 0.9909496903419495
         5 11 0.9485606551170349
         5 12 0.9591838717460632
         6 13 0.929610550403595
         6 14 0.8610178232192993
         6 24 1.442700147628784
         7 15 0.9538793563842773
         7 16 0.9425936341285706
         8 17 0.9576288461685181
         8 18 0.9598712921142578
         9 19 0.9591963291168213
         9 20 0.9483107328414917
         10 21 0.9570648670196533
         10 22 0.9424113035202026
         24 25 0.8305004835128784
         27 28 0.8779516816139221
         27 29 0.8774886131286621
    End
End

Engine ADF
    Basis
        Type TZP
        Core None
    End
    XC
        Hybrid B3LYP
    End
    Relativity
        Level None
    End
    Solvation
        Surf Delley
        Solv name=Water cav0=0.0 cav1=0.0067639
        Charged method=CONJ
        C-Mat POT
        SCF VAR ALL 
        CSMRSP
    End
EndEngine
eor


########
#do not change the rest of the file!
########

mv $JOB.results/ams.log $JOB.logfile
rm slurm-*.out

EOF_ALL

sbatch < $JOB.sbatch
