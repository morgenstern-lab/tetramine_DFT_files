#!/bin/bash

##########
#update the variables below as needed
##########

JOB=HMTpCH3O+_AlliH2O_IRCiH2 #this is the name of your job
		#make sure there are no spaces in the name
CURDIR=`'pwd'`  #do not change this line
TIME='23:00:00' #run time (hh:mm:ss) - 2 hours
NODES=1		#total number of nodes
TASKS=128        #total number of mpi tasks requested
		#should be 64 tasks per node

#########
#Do not change this next section!
#########
cat > $JOB.sbatch << EOF_ALL
#!/bin/sh

#SBATCH -J $JOB  	         # job name
#SBATCH -o $CURDIR/$JOB.out
#SBATCH -e $CURDIR/$JOB.err
#SBATCH -N $NODES                # total number of nodes 
#SBATCH -n $TASKS                # total number of mpi tasks requested
#SBATCH -t $TIME                 # run time (hh:mm:ss) - 1.5 hours

#!/bin/sh

AMS_JOBNAME=$JOB $AMSBIN/ams << eor

########
#replace the lines below with your adf input file
#starting with the "Task"
########

Task IRC
GeometryOptimization
    InitialHessian
        Type Calculate
    End
End
IRC
    InitialHessian
        Type FromFile
        File /home/jgertner/AMS/tetramine/HEXS_manual_calcs/HMT_step4/COSMO_s4/HMTpCH3O+_AlliH2O_TS_searchRCrev.results/adf.rkf
    End
    KeepConvergedResults No
    MinPathLength 1.0
    Step 1.5
End
System
    Atoms
        N 0.9752655498494763 -0.2446185701341365 -0.9067513374409084 adf.R=1.608
        N 0.1314139349966067 -0.02056816245054392 1.38232246892781 adf.R=1.608
        N 0.8927145283600064 2.185457931680412 -0.3193107312482953 adf.R=1.608
        N -1.176372212790229 0.7974995634341991 -0.5249601791952261 adf.R=1.608
        C 0.9525596405596063 -0.8179744702579819 0.4412260375340061 adf.R=1.7
        C 2.243289519206135 0.5019337225284037 4.2252287180583 adf.R=1.7
        C 1.611441745984004 1.08790961051859 -0.991774657994636 adf.R=1.7
        C -0.4112459228641916 -0.1218351539461217 -1.379690295277107 adf.R=1.7
        C -1.219645396855943 0.2400023984585186 0.8275562495930834 adf.R=1.7
        C -0.5518460236167263 2.134727667711956 -0.6093914006468191 adf.R=1.7
        H 0.5709553464198458 -1.843581225890807 0.3431644120496414 adf.R=1.35
        H 1.970513133615672 -0.873375849050839 0.829887994493595 adf.R=1.35
        H 2.497956533032939 1.439066135032775 4.708355698422483 adf.R=1.35
        H 1.265480909845364 0.0245603592943399 4.310154566343677 adf.R=1.35
        H 2.617810224672007 1.027856637239207 -0.5778962704733562 adf.R=1.35
        H 1.691719508993604 1.328371007001225 -2.054557673091503 adf.R=1.35
        H -0.8846854531887226 -1.10505847458979 -1.367447941827796 adf.R=1.35
        H -0.4106111715778122 0.2544735059205802 -2.403238526088639 adf.R=1.35
        H -1.736946450094346 0.9350282900831911 1.489955255859297 adf.R=1.35
        H -1.812416528652704 -0.6835728743912602 0.7703329525097552 adf.R=1.35
        H -1.066499531769899 2.808880031347103 0.07455740095183878 adf.R=1.35
        H -0.7122300381507868 2.491250753448225 -1.629616453117167 adf.R=1.35
        H 0.01234742815443117 -0.5505821636025907 2.242888316573165 adf.R=1.35
        O 3.091442302620042 -0.1076417223705029 3.532000330146756 adf.R=1.517
        H 3.962852231023565 0.3429298508269079 3.49707067525661 adf.R=1.35
        H 0.9949028068610267 2.034055625045088 0.6799916376100167 adf.R=1.35
        O -0.3602262378434788 -1.199592044905803 4.285411035643312 adf.R=1.517
        H -1.081611632017584 -0.8126731092529211 4.803158927813941 adf.R=1.35
        H -0.1715079334516636 -2.040703383773542 4.727110099114613 adf.R=1.35
    End
    Charge 1.0
    BondOrders
         1 5 0.9764117002487183
         1 7 0.9874771237373352
         1 8 0.9630978107452393
         2 5 0.9728771448135376
         2 9 0.9734500646591187
         2 23 0.9362745881080627
         3 7 0.9452708959579468
         3 10 0.9338595867156982
         3 26 0.7900782227516174
         4 8 0.9630528688430786
         4 9 0.9763554930686951
         4 10 0.9909496903419495
         5 11 0.9485606551170349
         5 12 0.9591838717460632
         6 13 0.929610550403595
         6 14 0.8610178232192993
         6 24 1.442700147628784
         7 15 0.9538793563842773
         7 16 0.9425936341285706
         8 17 0.9576288461685181
         8 18 0.9598712921142578
         9 19 0.9591963291168213
         9 20 0.9483107328414917
         10 21 0.9570648670196533
         10 22 0.9424113035202026
         24 25 0.8305004835128784
         27 28 0.8779516816139221
         27 29 0.8774886131286621
    End
End

Engine ADF
    Basis
        Type TZP
        Core None
    End
    XC
        Hybrid B3LYP
    End
    Relativity
        Level None
    End
    Solvation
        Surf Delley
        Solv name=Water cav0=0.0 cav1=0.0067639
        Charged method=CONJ
        C-Mat POT
        SCF VAR ALL 
        CSMRSP
    End
EndEngine
eor


########
#do not change the rest of the file!
########

mv $JOB.results/ams.log $JOB.logfile
rm slurm-*.out

EOF_ALL

sbatch < $JOB.sbatch
