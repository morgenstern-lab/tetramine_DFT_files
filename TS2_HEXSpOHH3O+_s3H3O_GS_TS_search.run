#!/bin/bash

##########
#update the variables below as needed
##########

JOB=HEXSpOHH3O+_s3H3O_GS_TS_search	#this is the name of your job
		#make sure there are no spaces in the name
CURDIR=`'pwd'`  #do not change this line
TIME='23:00:00' #run time (hh:mm:ss) - 2 hours
NODES=1		#total number of nodes
TASKS=128        #total number of mpi tasks requested
		#should be 64 tasks per node

#########
#Do not change this next section!
#########
cat > $JOB.sbatch << EOF_ALL
#!/bin/sh

#SBATCH -J $JOB  	         # job name
#SBATCH -o $CURDIR/$JOB.out
#SBATCH -e $CURDIR/$JOB.err
#SBATCH -N $NODES                # total number of nodes 
#SBATCH -n $TASKS                # total number of mpi tasks requested
#SBATCH -t $TIME                 # run time (hh:mm:ss) - 1.5 hours

#!/bin/sh

AMS_JOBNAME=$JOB $AMSBIN/ams << eor

########
#replace the lines below with your adf input file
#starting with the "Task"
########

Task TransitionStateSearch
Properties
    NormalModes Yes
End
GeometryOptimization
    InitialHessian
        Type Calculate
    End
End
System
    Atoms
        H 3.190738895054313 -1.021181985149912 2.974243222627237 
        O 3.153995309836835 -2.046552331462988 3.057642075912155 
        H 3.206037934801962 -2.332662430715041 3.988895802202472 
        H 2.187776350469909 -2.1648199544619 2.70338976880326 
        O 0.2116030412710234 -2.781946372093088 3.614470207674109 
        H -0.123474115548444 -2.214694945000748 4.324339754512571 
        N -1.749897495750538 -1.194268991011304 -0.1108253340448782 
        C -0.7527045596444804 -1.698123965483721 -1.070231318160623 
        N 0.5917779432008848 -1.230023886282559 -0.7461638760599478 
        C 1.317852367424015 -1.81954270438622 0.3516876092280636 
        N 0.8989126559652074 -1.487233516889005 1.7599008655648 
        C -0.2183183952132459 -2.26514608888429 2.37705681448524 
        N -1.323396230738201 1.415915098773042 -0.2227575227690935 
        C -0.4596829813317617 1.892321656569907 -1.310877399078847 
        N 0.9312022865062465 1.445654037263764 -1.13882882407554 
        C 1.462771117851305 1.788535706062846 0.1665976595288179 
        N 0.5874499203454304 1.271602431893865 1.255219557758608 
        C -0.8336842847207903 1.695382329180189 1.111654747150784 
        S -2.506743332775028 0.2772786165241443 -0.4701564224557443 
        S 1.34384916690151 -0.0740117106862915 -1.72637460750779 
        S 1.05292336509581 0.1502233217322895 2.311661090423076 
        O -2.825473259095451 0.3538738038883134 -1.868253922269976 
        O -3.478647788262158 0.4199209845488405 0.5756539288477247 
        O 0.7337510615227855 -0.1753642804418164 -3.01583225161058 
        O 2.751070492100371 -0.2124631809120292 -1.475960583557886 
        O 0.2082683905068708 0.2092320582332061 3.471510017791257 
        O 2.509584829692603 0.30560180865095 2.43142047967328 
        H -0.9800076126260084 -1.413796079154633 -2.095952307595956 
        H -0.7704602825240712 -2.787824215928533 -1.011711208013797 
        H 2.364279402782345 -1.551473750295335 0.2384024444476844 
        H 1.236493365816532 -2.907157025918074 0.2981425805389355 
        H -1.12013046264579 -1.66922510762806 2.470677903247928 
        H -0.4015300736559015 -3.10863096348537 1.713892809369999 
        H -0.4449982413434183 2.983764474840799 -1.288485260937106 
        H -0.8507109907457091 1.565253468112947 -2.267259148712608 
        H 1.46680538255286 2.876005656358605 0.2551918550080639 
        H 2.474484139885878 1.421361538054115 0.2879917131541352 
        H -0.8444386286657174 2.775235480146121 1.277206222397091 
        H -1.456012114586615 1.223801729785245 1.864543754610152 
        H -2.496033149660049 -1.863955910237264 0.06416588728353116 
    End
    Charge 1.0
    BondOrders
         1 2 1.0
         2 3 1.0
         4 2 1.0
         5 6 1.0
         5 12 1.0
         7 8 1.0
         7 19 1.0
         7 40 1.0
         8 9 1.0
         8 28 1.0
         8 29 1.0
         9 10 1.0
         9 20 1.0
         10 11 1.0
         10 30 1.0
         10 31 1.0
         11 12 1.0
         11 21 1.0
         12 32 1.0
         12 33 1.0
         13 14 1.0
         13 18 1.0
         13 19 1.0
         14 15 1.0
         14 34 1.0
         14 35 1.0
         15 16 1.0
         15 20 1.0
         16 17 1.0
         16 36 1.0
         16 37 1.0
         17 18 1.0
         17 21 1.0
         18 38 1.0
         18 39 1.0
         19 22 2.0
         19 23 2.0
         20 24 2.0
         20 25 2.0
         21 26 2.0
         21 27 2.0
    End
End

Engine ADF
    Basis
        Type TZP
        Core None
    End
    XC
        Hybrid B3LYP
    End
    Relativity
        Level None
    End
EndEngine
eor


########
#do not change the rest of the file!
########

mv $JOB.results/ams.log $JOB.logfile
rm slurm-*.out

EOF_ALL

sbatch < $JOB.sbatch
