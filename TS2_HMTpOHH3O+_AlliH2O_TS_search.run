#!/bin/bash

##########
#update the variables below as needed
##########

JOB=HMTpOHH3O+_AlliH2O_TS_search	#this is the name of your job
		#make sure there are no spaces in the name
CURDIR=`'pwd'`  #do not change this line
TIME='23:00:00' #run time (hh:mm:ss) - 2 hours
NODES=1		#total number of nodes
TASKS=128        #total number of mpi tasks requested
		#should be 64 tasks per node

#########
#Do not change this next section!
#########
cat > $JOB.sbatch << EOF_ALL
#!/bin/sh

#SBATCH -J $JOB  	         # job name
#SBATCH -o $CURDIR/$JOB.out
#SBATCH -e $CURDIR/$JOB.err
#SBATCH -N $NODES                # total number of nodes 
#SBATCH -n $TASKS                # total number of mpi tasks requested
#SBATCH -t $TIME                 # run time (hh:mm:ss) - 1.5 hours

#!/bin/sh

AMS_JOBNAME=$JOB $AMSBIN/ams << eor

########
#replace the lines below with your adf input file
#starting with the "Task"
########

Task TransitionStateSearch
Properties
    NormalModes Yes
End
GeometryOptimization
    InitialHessian
        Type Calculate
    End
End
System
    Atoms
        N 0.7551667863291838 -0.8516707169632579 -0.4420815924240811 adf.R=1.608
        N -1.094482064600869 -1.300106249702405 1.15684449751286 adf.R=1.608
        N 1.069173458430295 0.9551815683413925 1.251769963647059 adf.R=1.608
        N -0.9600125028104449 0.7977906634215054 -0.1837274090826468 adf.R=1.608
        C -0.05357557278846427 -1.850070363085955 0.2888460448298577 adf.R=1.7
        C 2.019278260907733 1.906997976582228 1.687030253883877 adf.R=1.7
        C 1.696108552274615 -0.09644912987921148 0.3285790468893698 adf.R=1.7
        C -0.1478937561172549 0.05470554666202362 -1.154802391042383 adf.R=1.7
        C -1.799167209813103 -0.1638707457664312 0.5660862311150373 adf.R=1.7
        C -0.1214915710496418 1.666166447701363 0.5788626871618772 adf.R=1.7
        H -0.5291823955203424 -2.467689793525184 -0.4752504297633626 adf.R=1.35
        H 0.6026721300986283 -2.491506864327098 0.8753647364698647 adf.R=1.35
        H 2.840988689800224 2.111486887509578 0.995391184758562 adf.R=1.35
        H 1.546352394601399 2.829361191713519 2.022389182428959 adf.R=1.35
        H 2.292895013749531 -0.7631056246550112 0.9515451879913409 adf.R=1.35
        H 2.368111937956576 0.428274003042701 -0.3621101261102896 adf.R=1.35
        H -0.8020581273280233 -0.5229945863150307 -1.805856814122872 adf.R=1.35
        H 0.4260558168182025 0.7498427519791796 -1.770271592565973 adf.R=1.35
        H -2.352207821107384 0.3660965094642252 1.341273191903744 adf.R=1.35
        H -2.524588431446289 -0.5452424048885066 -0.1549538551518411 adf.R=1.35
        H -0.6906690679013197 2.159128949356378 1.369493062215733 adf.R=1.35
        H 0.2713898334678 2.433041149581789 -0.09749743355275654 adf.R=1.35
        H -0.7423385859013073 -1.100307189101398 2.082069649962247 adf.R=1.35
        O 2.750451944785175 1.3201774548977 2.905872843306956 adf.R=1.517
        H 3.310951710689152 1.979497510307193 3.352088826879904 adf.R=1.35
        H 0.5008955096171952 0.2373193509215123 3.01725132034825 adf.R=1.35
        O 0.9302106209935819 0.1223428599372605 3.905899946354899 adf.R=1.517
        H 0.3281622897370021 0.4107837459593247 4.609288256679344 adf.R=1.35
        H 1.995622962042589 0.8370449821986217 3.566342828140459 adf.R=1.35
    End
    Charge 1.0
    BondOrders
         1 5 1.0
         1 7 1.0
         1 8 1.0
         2 5 1.0
         2 9 1.0
         2 23 1.0
         3 6 1.0
         3 7 1.0
         3 10 1.0
         4 8 1.0
         4 9 1.0
         4 10 1.0
         5 11 1.0
         5 12 1.0
         6 13 1.0
         6 14 1.0
         6 24 1.0
         7 15 1.0
         7 16 1.0
         8 17 1.0
         8 18 1.0
         9 19 1.0
         9 20 1.0
         10 21 1.0
         10 22 1.0
         24 25 1.0
         26 27 1.0
         27 28 1.0
         27 29 1.0
    End
End

Engine ADF
    Basis
        Type TZP
        Core None
    End
    XC
        Hybrid B3LYP
    End
    Relativity
        Level None
    End
    Solvation
        Surf Delley
        Solv name=Water cav0=0.0 cav1=0.0067639
        Charged method=CONJ
        C-Mat POT
        SCF VAR ALL 
        CSMRSP
    End
EndEngine
eor


########
#do not change the rest of the file!
########

mv $JOB.results/ams.log $JOB.logfile
rm slurm-*.out

EOF_ALL

sbatch < $JOB.sbatch
